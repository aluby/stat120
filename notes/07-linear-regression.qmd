---
title: "Notes 07: Linear Regression"
---

```{r setup, include=FALSE, message=FALSE}
library(tidyverse)
library(patchwork)
library(palmerpenguins)
library(broom)

options(digits = 4)
notes_theme = theme_minimal(base_size = 12, base_family = "Source Sans 3")
theme_set(notes_theme)
```

:::: {layout-ncol="2"}
::: {}
```{r}
ggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm)) + 
  geom_point(size = .5) + 
  geom_smooth(method = "lm", se = FALSE)
```
:::

::: {}
```{r}
penguins_lm = lm(flipper_length_mm ~ body_mass_g, data = penguins)
equatiomatic::extract_eq(penguins_lm, use_coefs = TRUE)
```
:::

::::

- Intercept ($b_0$): where does the line cross the y-axis? What is the *prediction* for $x=0$?

- Slope ($b_1$): For a 1-unit increase in $x$, what is the change in the *prediction* for $y$? 

::: callout-note
Observation

\vspace{.5in}

:::

::: callout-note
Prediction

\vspace{.5in}

:::

::: callout-note
Residual

\vspace{.5in}

:::

**Example:** I grab a penguin with a flipper length of 193mm and a body mass of 3475g. What is the **observation**, **prediction**, and **residual** in this case?

\vspace{1in}

**Example:** Emperor penguins routinely make dives of 5-12 minutes, with the longest recorded dive over 27 minutes (!!) The rate of oxygen depletion is primarily determined by the penguin's heart rate. `DiveHeartRate` is the bird's heart rate in beats per minute, `Depth` is the depth of the dive (in meters), `Duration` is the duration of the dive in minutes, and `Bird` is an ID variable indicating which penguin made the dive. 

```{r}
penguin_dives = read_csv("http://www.math.carleton.edu/aluby/data/penguin_dives.csv")
```

```{r, echo = FALSE}
#| fig-width: 3
#| fig-height: 2
#| fig-align: left
ggplot(penguin_dives, aes(x = Duration, y = DiveHeartRate)) + 
  geom_point(size = .5)
```

It can be helpful to look at a *residual scatterplot* when checking for linearity and outliers. 

```{r}
#| echo: true
#| fig-width: 3
#| fig-height: 2
dives_lm = lm(DiveHeartRate ~ Duration, data = penguin_dives)
dives_aug = augment(dives_lm)
p1 = ggplot(dives_aug, aes(x = .fitted, y = .resid)) + 
  geom_point(size = .5) + 
  geom_hline(yintercept =0)
```


```{r}
#| fig-width: 6
#| fig-height: 2
p2 = ggplot(dives_aug, aes(x = .fitted, y = .resid)) + 
  geom_hline(yintercept =0) + 
  ylim(c(-25, 25)) + 
  xlim(c(0,100)) + 
  labs(title = "What would an ideal residual plot look like?") + 
  theme(plot.title = element_text(size = 8))

p1 + p2
```

Below is the slope and intercept for the transformed model. Write out the linear regression equation and provide an in-context interpretation of the intercept and slope. 

```{r}
dives_lm2 = lm(-1/DiveHeartRate ~ Duration, data = penguin_dives)
coef(dives_lm2)
```


